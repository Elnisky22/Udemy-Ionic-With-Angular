"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3870],{3870:(M,p,g)=>{g.r(p),g.d(p,{BookingsPageModule:()=>r});var u=g(177),v=g(4341),e=g(7125),k=g(1313),o=g(9498),b=g(8244);function h(i,a){1&i&&(o.j41(0,"div",7),o.nrm(1,"ion-spinner",8),o.k0s())}function I(i,a){if(1&i){const t=o.RV6();o.j41(0,"ion-item-sliding",null,0)(2,"ion-item")(3,"ion-avatar",2),o.nrm(4,"img",12),o.k0s(),o.j41(5,"ion-label")(6,"h5"),o.EFF(7),o.k0s(),o.j41(8,"p"),o.EFF(9),o.k0s()()(),o.j41(10,"ion-item-options",13)(11,"ion-item-option",14),o.bIt("click",function(){const l=o.eBV(t).$implicit,d=o.sdS(1),B=o.XpG(3);return o.Njj(B.onCancel(l.id,d))}),o.nrm(12,"ion-icon",15),o.k0s()()()}if(2&i){const t=a.$implicit;o.R7$(4),o.Y8G("src",t.placeImage,o.B4B)("alt",t.placeTitle),o.R7$(3),o.JRh(t.placeTitle),o.R7$(2),o.SpI("Guests: ",t.guestNumber,"")}}function P(i,a){if(1&i&&(o.j41(0,"ion-col",10)(1,"ion-list")(2,"ion-list"),o.DNE(3,I,13,4,"ion-item-sliding",11),o.k0s()()()),2&i){const t=o.XpG(2);o.R7$(3),o.Y8G("ngForOf",t.loadedBookings)}}function j(i,a){1&i&&(o.j41(0,"ion-col",10)(1,"p",7),o.EFF(2,"No bookings found!"),o.k0s()())}function c(i,a){if(1&i&&(o.j41(0,"ion-grid")(1,"ion-row"),o.DNE(2,P,4,1,"ion-col",9)(3,j,3,0,"ion-col",9),o.k0s()()),2&i){const t=o.XpG();o.R7$(2),o.Y8G("ngIf",t.loadedBookings&&t.loadedBookings.length>0),o.R7$(),o.Y8G("ngIf",!t.isLoading&&(!t.loadedBookings||t.loadedBookings.length<=0))}}const f=[{path:"",component:(()=>{var i;class a{constructor(s,l){this.bookingService=s,this.loadingCtrl=l,this.loadedBookings=[],this.isLoading=!1}ngOnInit(){this.bookingSub=this.bookingService.bookings.subscribe(s=>{this.loadedBookings=s})}ionViewWillEnter(){this.isLoading=!0,this.bookingService.fetchBookings().subscribe(()=>{this.isLoading=!1})}ngOnDestroy(){this.bookingSub&&this.bookingSub.unsubscribe()}onCancel(s,l){l.close(),this.loadingCtrl.create({message:"Cancelling booking..."}).then(d=>{d.present(),this.bookingService.cancelBooking(s).subscribe(()=>{d.dismiss()})})}}return(i=a).\u0275fac=function(s){return new(s||i)(o.rXU(b.L),o.rXU(e.Xi))},i.\u0275cmp=o.VBU({type:i,selectors:[["app-bookings"]],standalone:!1,decls:9,vars:4,consts:[["slidingItem",""],[3,"translucent"],["slot","start"],["menu","main-menu"],[3,"fullscreen"],["class","ion-text-center",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center"],["name","bubbles"],["size","12","size-md","6","offset-md","3",4,"ngIf"],["size","12","size-md","6","offset-md","3"],[4,"ngFor","ngForOf"],[3,"src","alt"],["side","end"],["color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(s,l){1&s&&(o.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),o.nrm(3,"ion-menu-button",3),o.k0s(),o.j41(4,"ion-title"),o.EFF(5,"Your Bookings"),o.k0s()()(),o.j41(6,"ion-content",4),o.DNE(7,h,2,0,"div",5)(8,c,4,2,"ion-grid",6),o.k0s()),2&s&&(o.Y8G("translucent",!0),o.R7$(6),o.Y8G("fullscreen",!0),o.R7$(),o.Y8G("ngIf",l.isLoading),o.R7$(),o.Y8G("ngIf",!l.isLoading))},dependencies:[u.Sq,u.bT,e.mC,e.QW,e.hU,e.W9,e.lO,e.eU,e.iq,e.uz,e.LU,e.CE,e.A7,e.he,e.nf,e.MC,e.ln,e.w2,e.BC,e.ai],encapsulation:2}),a})()}];let n=(()=>{var i;class a{}return(i=a).\u0275fac=function(s){return new(s||i)},i.\u0275mod=o.$C({type:i}),i.\u0275inj=o.G2t({imports:[k.iI.forChild(f),k.iI]}),a})(),r=(()=>{var i;class a{}return(i=a).\u0275fac=function(s){return new(s||i)},i.\u0275mod=o.$C({type:i}),i.\u0275inj=o.G2t({imports:[u.MD,v.YN,e.bv,n]}),a})()},8244:(M,p,g)=>{g.d(p,{L:()=>j});var u=g(4412),v=g(6354),e=g(8141),k=g(5558),o=g(6697);class b{constructor(m,f,n,r,i,a,t,s,l,d){this.id=m,this.placeId=f,this.userId=n,this.placeTitle=r,this.placeImage=i,this.firstName=a,this.lastName=t,this.guestNumber=s,this.bookedFrom=l,this.bookedTo=d}}var h=g(9498),I=g(5498),P=g(1626);let j=(()=>{var c;class m{get bookings(){return this._bookings.asObservable()}constructor(n,r){this.authService=n,this.http=r,this._bookings=new u.t([])}fetchBookings(){return this.http.get(`https://ionic-angular-6476b-default-rtdb.firebaseio.com/bookings.json?orderBy="userId"&equalTo="${this.authService.userId}"`).pipe((0,v.T)(n=>{const r=[];for(const i in n)n.hasOwnProperty(i)&&r.push(new b(i,n[i].placeId,n[i].userId,n[i].placeTitle,n[i].placeImage,n[i].firstName,n[i].lastName,n[i].guestNumber,new Date(n[i].bookedFrom),new Date(n[i].bookedTo)));return r}),(0,e.M)(n=>{this._bookings.next(n)}))}addBooking(n,r,i,a,t,s,l,d){let B;const S=new b(Math.random().toString(),n,this.authService.userId,r,i,a,t,s,l,d);return this.http.post("https://ionic-angular-6476b-default-rtdb.firebaseio.com/bookings.json",{...S,id:null}).pipe((0,k.n)(F=>(B=F.name,this.bookings)),(0,o.s)(1),(0,e.M)(F=>{S.id=B,this._bookings.next(F.concat(S))}))}cancelBooking(n){return this.http.delete(`https://ionic-angular-6476b-default-rtdb.firebaseio.com/bookings/${n}.json`).pipe((0,k.n)(()=>this.bookings),(0,o.s)(1),(0,e.M)(r=>{this._bookings.next(r.filter(i=>i.id!==n))}))}}return(c=m).\u0275fac=function(n){return new(n||c)(h.KVO(I.u),h.KVO(P.Qq))},c.\u0275prov=h.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),m})()}}]);